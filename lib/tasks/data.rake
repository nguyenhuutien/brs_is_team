namespace :db do
  desc "Import Data"
  task datas: [:environment] do

    5.times do |n|
      name  = Faker::Name.name
      email = "example-#{n+1}@gmail.com"
      password = "123456"
      User.create! name: name, email: email, password: password,
        password_confirmation: password,
        image: Rails.root.join("app/assets/images/hai.jpg").open
    end

    User.create! name: "Nguyen Huu Tien", email: "tiennh1995@gmail.com", password: "123456",
      password_confirmation: "123456", admin: true

    2.times do
      Category.create! name: Faker::Book.title
    end

    Category.all.each do |category|
      7.times do |n|
        author = Author.new name: Faker::Name.name
        book = category.books.create! title: Faker::Book.title, description: "Tất cả những trải nghiệm trong chuyến phiêu du theo đuổi vận mệnh của mình đã giúp Santiago thấu hiểu được ý nghĩa sâu xa nhất của hạnh phúc, hòa hợp với vũ trụ và con người.Tiểu thuyết Nhà giả kim của Paulo Coelho như một câu chuyện cổ tích giản dị, nhân ái, giàu chất thơ, thấm đẫm những minh triết huyền bí của phương Đông. Trong lần xuất bản đầu tiên tại Brazil vào năm 1988, sách chỉ bán được 900 bản. Nhưng, với số phận đặc biệt của cuốn sách dành cho toàn nhân loại, vượt ra ngoài biên giới quốc gia, Nhà giả kim đã làm rung động hàng triệu tâm hồn, trở thành một trong những cuốn sách bán chạy nhất mọi thời đại, và có thể làm thay đổi cuộc đời người đọc. “Nhưng nhà luyện kim đan không quan tâm mấy đến những điều ấy. Ông đã từng thấy nhiều người đến rồi đi, trong khi ốc đảo và sa mạc vẫn là ốc đảo và sa mạc. Ông đã thấy vua chúa và kẻ ăn xin đi qua biển cát này, cái biển cát thường xuyên thay hình đổi dạng vì gió thổi nhưng vẫn mãi mãi là biển cát mà ông đã biết từ thuở nhỏ. Tuy vậy, tự đáy lòng mình, ông không thể không cảm thấy vui trước hạnh phúc của mỗi người lữ khách, sau bao ngày chỉ có cát vàng với trời xanh nay được thấy chà là xanh tươi hiện ra trước mắt. ‘Có thể Thượng đế tạo ra sa mạc chỉ để cho con người biết quý trọng cây chà là,’ ông nghĩ.",
          publish_date: Date.new(2016, 11, 9), pages: 987, authors: [author],
          photo: Rails.root.join("app/assets/images/#{n + 1}.jpg").open
        FavoriteAuthor.create! user_id: 1, author: Author.last
        Notification.create! recipient_id: 1, book: book, author: Author.last
      end
    end

    User.all.each do |user|
      Book.all.each do |book|
        user.reviews.create! content: "Tất cả những trải nghiệm trong chuyến phiêu du theo đuổi vận mệnh của mình đã giúp Santiago thấu hiểu được ý nghĩa sâu xa nhất của hạnh phúc, hòa hợp với vũ trụ và con người.Tiểu thuyết Nhà giả kim của Paulo Coelho như một câu chuyện cổ tích giản dị, nhân ái, giàu chất thơ, thấm đẫm những minh triết huyền bí của phương Đông.",
          title: "Good book", rate: 3, book_id: book.id
        book.update_attributes sum_point: (book.sum_point + 3), sum_rate: (book.sum_rate + 1)
      end
    end

    5.times do |i|
      review = Review.find_by_id (i + 1)
      review.comments.create! user_id: 1, content: "Tất cả những trải nghiệm trong chuyến phiêu du theo đuổi vận mệnh của mình đã giúp Santiago thấu hiểu được ý nghĩa sâu xa nhất của hạnh phúc, hòa hợp với vũ trụ và con người.Tiểu thuyết Nhà giả kim của Paulo Coelho như một câu chuyện cổ tích giản dị, nhân ái, giàu chất thơ, thấm đẫm những minh triết huyền bí của phương Đông."
    end

    User.all.each do |user|
      Request.create! user_id: user.id, book_title: Faker::Book.title, book_author: Faker::Book.author,
        book_publish_date: Date.new(2016, 11, 9)
    end
  end
end
